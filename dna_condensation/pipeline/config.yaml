# DNA Condensation Quantification Configuration
# Edit the values below for your specific analysis

# ==== FILE PATHS ====
# REQUIRED: Set the path to your ND2 files
raw_nd2_path: "G:/My Drive/KatzLab/DNA-condensation-quantification/raw_nd2"  # Path to folder containing ND2 files
output_path: "./output"         # Where to save results
temp_path: "./temp"             # Temporary processing files

# ==== MICROSCOPE SETTINGS ====
# Adjust these based on your microscope configuration
image_channels:
  - "Channel_0"    # LSD1 GFP channel
  - "Channel_1"    # DNA staining channel

# ==== SEGMENTATION SETTINGS ====
# Channel selection for nucleus segmentation
segmentation_channel_index: 1   # index to use for quantification (1 = DNA staining channel) 
# Segmentation method: 'yolo' (AI-based) or 'watershed' (traditional image processing)
segmentation_method: "otsu"    # Options: "yolo", "watershed", 'otsu'

# Size-based filtering (removes small objects relative to median size)
size_filtering:
  enabled: true                 # Enable/disable size-based filtering
  min_size_percentage: 20       # Minimum size as percentage of median (e.g., 20 = 20% of median)

#=== SIZE FILTERING SUMMARY EXAMPLE ===
# Original objects: 66
#  5% filter:  66 objects (  0.0% removed)
# 10% filter:  66 objects (  0.0% removed)
# 20% filter:  64 objects (  3.0% removed)
# 30% filter:  62 objects (  6.1% removed)

# ==== PROCESSING SETTINGS ====
# Preprocessing options for homogeneity analysis
preprocessing:
  background_correction: true   # Apply rolling ball background correction (RECOMMENDED)
  deconvolution: false         # Apply Richardson-Lucy deconvolution (optional, slower)
  intensity_normalization: true # Apply global intensity normalization (recommended for batch comparison)
  per_nucleus_normalization: false  # Apply per-nucleus normalization for homogeneity analysis
  # Advanced parameters
  bg_ball_radius: 75           # Rolling ball radius (adjust based on nucleus size)
  deconv_iterations: 10        # Deconvolution iterations
  norm_method: "percentile"    # Normalization method: percentile, zscore, minmax, target_mean

# Z-axis collapse method
z_collapse_method: "mean"       # Options: "max", "mean", "sum", "median"

# GPU acceleration
use_gpu: true                   # Enable GPU acceleration if available

# Plotting and visualization
plot:
  plot_segmentation: false       # Enable/disable segmentation result visualization
  single_metric_plot:
    enabled: true                # Enable/disable single metric standalone plot
    metric: "glcm_homogeneity_mean"  # Metric to plot (set to null/none to disable)
    # Available metrics include:
    # Intensity: mean_intensity, std_intensity, intensity_entropy, high_intensity_fraction, etc.
    # Morphology: area, perimeter, circularity, solidity, etc.
    # Texture: glcm_homogeneity_mean, glcm_contrast_mean, glcm_energy_mean, etc.
    # Granulometry: granulometry_area_fraction_r5, granulometry_spots_r5, etc.
    # Spatial: radial_shell_0, center_to_edge_ratio, etc.
  nuclei_panel:
    enabled: true               # Enable/disable nuclei panel plot
    n_nuclei: 12                # How many nuclei to show
    metrics:                    # Metrics to annotate per nucleus
      - glcm_homogeneity_mean
      - intensity_entropy
    group: null                 # Optional group filter; null means sample randomly from all
    group_column: condition     # Which column stores group labels
    colormap: magma             # Colormap to emphasize intensity differences
    channel_index: 1            # Channel to visualize when image has multiple channels
    save_name: nuclei_panel.png # Output filename

# Verbose output
verbose: true                   # Print detailed progress information